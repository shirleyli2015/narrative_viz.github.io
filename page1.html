<html lang="en">
<title>Protein Sources in Plant-Based Diets</title>
<script src='https://d3js.org/d3.v5.min.js'></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body,h1,h2,h3,h4,h5 {font-family: "Poppins", sans-serif}
body {font-size:16px;}
.w3-half img{margin-bottom:-6px;margin-top:16px;opacity:0.8;cursor:pointer}
.w3-half img:hover{opacity:1}
</style>

<body>
  <div id="bar_chart" style="margin-top:75px">
    <h1 ><b>A Look at Protein in Plant-Based Diets</b></h1>
    <h2 ><b>You just eat plants... right?</b></h2>
    <p>Many people associate a plant-based diet with just eating fruits, vegetables, and grains. While fruits and vegetables are lower in calories and high in vitamins, they are low in protein. This causes some people to be hesitant to adopt a plant-based diet because of concerns of getting adequate protein intake without eating meat.</p>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v6.js"></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

<script>
const type = d3.annotationCalloutCircle
const annotations = [{
    note: { label: "Fruits, vegetables, and grains are lower in protein" },
    x: 95,
    y: 260,
    dy: -100,
    dx: 0,
    subject: { radius: 95, radiusPadding: 10 },
  }]
const makeAnnotations = d3.annotation()
  .type(type)
  .annotations(annotations)


const margin = {top: 30, right: 300, bottom: 150, left: 100},
    width = 900 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

const svg = d3.select("#bar_chart")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", `translate(${margin.left}, ${margin.top})`);
    

    svg.append("text")
       .attr("transform", "translate(0,0)")
       .attr("x", 30)
       .attr("y", -10)
       .attr("font-size", "24px")
       .text("Protein Amount in Food Categories")

d3.csv("https://raw.githubusercontent.com/shirleyli2015/narrative_viz.github.io/master/data/MyFoodData_Nutrition_Facts_SpreadSheet_1.csv").then ( function(data) {

  data.sort(function(b, a) {
    return a.Value - b.Value;
  });

  const x = d3.scaleBand()
    .range([ 0, width ])
    .domain(data.map(d => d.Food_Category))
    .padding(0.2);
  svg.append("g")
    .attr("transform", `translate(0, ${height})`)
    .call(d3.axisBottom(x))
    .selectAll("text")
      .attr("transform", "translate(-10,0)rotate(-45)")
      .style("text-anchor", "end");

  const y = d3.scaleLinear()
    .domain([0,25])
    .range([ height, 0]);
  svg.append("g")
    .call(d3.axisLeft(y));
         
  svg.append("text")
      .attr("text-anchor", "end")
      .attr("x", width/2+20)
      .attr("y", height + margin.top + 75)
      .text("Food Category");

  svg.append("text")
      .attr("text-anchor", "end")
      .attr("transform", "rotate(-90)")
      .attr("y", -margin.left+60)
      .attr("x", -margin.top)
      .text("Average Protein (g) per Serving");

  var bar = svg.selectAll("mybar")
    .data(data)
    .enter()
    .append("g");
              
    bar.append("rect")
      .attr("x", d => x(d.Food_Category))
      .attr("y", d => y(d['Average of Protein (g)']))
      .attr("width", x.bandwidth())
      .attr("height", d => height - y(d['Average of Protein (g)']))
      .attr("fill", "#69b3a2");     
      
    bar.append("text")
        .attr("x", function (d) { return x(d.Food_Category)+15; })
        .attr("y", function (d) { return y(d['Average of Protein (g)']) - 10; })
        .attr("dy", ".5em")
        .text(function (d) { return Math.round(d['Average of Protein (g)']); })
        .style("font-size", "10px");

    bar.append("svg").attr("class", "annotation-group")
          .call(makeAnnotations);
})
</script>
  </div>
</body>
<button type="button" onclick="location.href='https://shirleyli2015.github.io/narrative_viz.github.io/page2.html';">Next</button>
</html>