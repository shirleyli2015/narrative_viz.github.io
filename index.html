<html lang="en">
<title>W3.CSS Template</title>
<script src='https://d3js.org/d3.v5.min.js'></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins"> -->
<style>
body,h1,h2,h3,h4,h5 {font-family: "Poppins", sans-serif}
body {font-size:16px;}
.w3-half img{margin-bottom:-6px;margin-top:16px;opacity:0.8;cursor:pointer}
.w3-half img:hover{opacity:1}
</style>
<body>



<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-red w3-collapse w3-top w3-large w3-padding" style="z-index:3;width:300px;font-weight:bold;" id="mySidebar"><br>
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-button w3-hide-large w3-display-topleft" style="width:100%;font-size:22px">Close Menu</a>
  <div class="w3-container">
    <h3 class="w3-padding-64"><b>Nutrition<br>Viz</b></h3>
  </div>
  <div class="w3-bar-block">
    <a href="#bar_chart" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">bar chart</a> 
    <a href="#scatter_plot" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">line graph</a> 
    <a href="#bubble_chart" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">bubble graph</a> 
  </div>
</nav>

<!-- Top menu on small screens -->
<header class="w3-container w3-top w3-hide-large w3-red w3-xlarge w3-padding">
  <a href="javascript:void(0)" class="w3-button w3-red w3-margin-right" onclick="w3_open()">â˜°</a>
  <span>Company Name</span>
</header>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<!-- <div class="w3-main" style="margin-left:340px;margin-right:40px"> -->
  <!-- bar_chart -->
  <div class="w3-container" id="bar_chart" style="margin-top:75px">
    <h1 class="w3-xxxlarge w3-text-red"><b>bar chart.</b></h1>
    <hr style="width:50px;border:5px solid red" class="w3-round">
    <p>We are a interior design service that focus on what's best for your home and what's best for you!</p>
    <meta charset="utf-8">
    
<html><body>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>
          
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>
<script>
// set the dimensions and margins of the graph
const margin = {top: 30, right: 300, bottom: 150, left: 100},
    width = 900 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// append the svg object to the body of the page
const svg = d3.select("#my_dataviz")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", `translate(${margin.left}, ${margin.top})`);

    svg.append("text")
       .attr("transform", "translate(0,0)")
       .attr("x", 30)
       .attr("y", -10)
       .attr("font-size", "24px")
       .text("Average Calories per Serving")

// Parse the Data
d3.csv("https://raw.githubusercontent.com/shirleyli2015/narrative_viz.github.io/master/data/MyFoodData_Nutrition_Facts_SpreadSheet_1.csv").then ( function(data) {

  // sort data
  data.sort(function(b, a) {
    return a.Value - b.Value;
  });

  // X axis
  const x = d3.scaleBand()
    .range([ 0, width ])
    .domain(data.map(d => d.Food_Category))
    .padding(0.2);
  svg.append("g")
    .attr("transform", `translate(0, ${height})`)
    .call(d3.axisBottom(x))
    .selectAll("text")
      .attr("transform", "translate(-10,0)rotate(-45)")
      .style("text-anchor", "end");

  // Add Y axis
  const y = d3.scaleLinear()
    .domain([0,700])
    .range([ height, 0]);
  svg.append("g")
    .call(d3.axisLeft(y));
         
  svg.append("text")
      .attr("text-anchor", "end")
      .attr("x", width/2+20)
      .attr("y", height + margin.top + 75)
      .text("Food Category");
   // Y axis label:
  svg.append("text")
      .attr("text-anchor", "end")
      .attr("transform", "rotate(-90)")
      .attr("y", -margin.left+60)
      .attr("x", -margin.top)
      .text("Calories");
  // Bars
  var bar = svg.selectAll("mybar")
    .data(data)
    .enter()
    .append("g");
              
    bar.append("rect")
      .attr("x", d => x(d.Food_Category))
      .attr("y", d => y(d.Avg_Cal_per_Serving))
      .attr("width", x.bandwidth())
      .attr("height", d => height - y(d.Avg_Cal_per_Serving))
      .attr("fill", "#69b3a2");     
      
    bar.append("text")
        .attr("x", function (d) { return x(d.Food_Category)+15; })
        .attr("y", function (d) { return y(d.Avg_Cal_per_Serving) - 10; })
        .attr("dy", ".5em")
        .text(function (d) { return Math.round(d.Avg_Cal_per_Serving); })
        .style("font-size", "10px");

    
})
</script>
</body></html>
  <!-- scatter_plot -->
  <div class="w3-container" id="scatter_plot" style="margin-top:75px">
    <h1 class="w3-xxxlarge w3-text-red"><b>scatter_plot.</b></h1>
    <hr style="width:50px;border:5px solid red" class="w3-round">
    <p>The best team in the world.</p>
  </div>
  
  <!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div id="my_dataviz2"></div>
<script>

/* // set the dimensions and margins of the graph
var margin = {top: 10, right: 30, bottom: 40, left: 50},
    width = 520 - margin.left - margin.right,
    height = 520 - margin.top - margin.bottom;
 */
// append the svg object to the body of the page
var Svg = d3.select("#my_dataviz2")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")")




d3.csv("https://raw.githubusercontent.com/shirleyli2015/narrative_viz.github.io/master/data/MyFoodData_Nutrition_Facts_SpreadSheet_2.csv", function(data) {
	console.log(data[1])
  // Add X axis
  var x = d3.scaleLinear()
    .domain([0, 100])
    .range([ 0, width ])
  Svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x).tickSize(-height*1.3).ticks(10))
    .select(".domain").remove()

  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, 1000])
    .range([ height, 0])
    .nice()
  Svg.append("g")
    .call(d3.axisLeft(y).tickSize(-width*1.3).ticks(7))
    .select(".domain").remove()

  // Customization
  Svg.selectAll(".tick line").attr("stroke", "#EBEBEB")

  // Add X axis label:
  Svg.append("text")
      .attr("text-anchor", "end")
      .attr("x", width)
      .attr("y", height + margin.top + 20)
      .text("Sepal Length");

  // Y axis label:
  Svg.append("text")
      .attr("text-anchor", "end")
      .attr("transform", "rotate(-90)")
      .attr("y", -margin.left+20)
      .attr("x", -margin.top)
      .text("Petal Length")

  // Color scale: give me a specie name, I return a color
  var color = d3.scaleOrdinal()
    .domain(["Beans and Lentils", "Vegetables", "Fruits","Grains and Pasta", "Nuts and Seeds", "Fish","Dairy and Egg Products","Meats", "Fats and Oils" ])
    .range([ "#00CC00","#00CC00","#00CC00", "#00CC00","#00CC00","#CC0000", "#CC0000","#CC0000","#C0C0C0"])

  // Add dots
  Svg.append('g')
    .selectAll("dot")
    .data(data)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(d.Protein); } )
      .attr("cy", function (d) { return y(d.Calories); } )
      .attr("r", 1)
      .style("fill", function (d) { return color(d.Food_Group) } )
      
      
  // create a list of keys
var keys = ["Plant-based", "Animal Products", "Fats/Oils"]

// Usually you have a color scale in your chart already
var color = d3.scaleOrdinal()
  .domain(keys)
  .range(["#00CC00","#CC0000" ,"#C0C0C0"]);

// Add one dot in the legend for each name.
var size = 20
Svg.selectAll("mydots")
  .data(keys)
  .enter()
  .append("rect")
    .attr("x", 560)
    .attr("y", function(d,i){ return i*(size+5)}) // 100 is where the first dot appears. 25 is the distance between dots
    .attr("width", size)
    .attr("height", size)
    .style("fill", function(d){ return color(d)})

// Add one dot in the legend for each name.
Svg.selectAll("mylabels")
  .data(keys)
  .enter()
  .append("text")
    .attr("x", 560 + size*1.2)
    .attr("y", function(d,i){ return i*(size+5) + (size/2)}) // 100 is where the first dot appears. 25 is the distance between dots
    .style("fill", function(d){ return color(d)})
    .text(function(d){ return d})
    .attr("text-anchor", "left")
    .style("alignment-baseline", "middle")

})

</script>
  <!-- bubble_chart / Pricing Tables -->
  <div class="w3-container" id="bubble_chart" style="margin-top:75px">
    <h1><b>bubble_chart.</b></h1>
    <p>Some text our prices.</p>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>
        
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>

<script>

// append the svg3 object to the body of the page
const svg3 = d3.select("#bubble_chart")
.append("svg")
  .attr("width", 1500)
  .attr("height", 600)

// Read data
d3.csv("https://raw.githubusercontent.com/shirleyli2015/narrative_viz.github.io/master/data/MyFoodData_Nutrition_Facts_SpreadSheet_3.csv").then( function(data) {

// Filter a bit the data -> more than 1 million inhabitants
data = data.filter(function(d){ return d['Protein (g)']>20 })

// Color palette for continents?
const color = d3.scaleOrdinal()
  .domain(["Beans and Lentils", "Vegetables", "Fruits","Grains and Pasta", "Nuts and Seeds"])
  .range(d3.schemeSet1);

// Size scale for countries
const size = d3.scaleLinear()
  .domain([0, 150])
  .range([1,55])  // circle will be between 7 and 55 px wide

// create a tooltip
const Tooltip = d3.select("#bubble_chart")
  .append("div")
  .style("opacity", 0)
  .attr("class", "tooltip")
  .style("background-color", "white")
  .style("border", "solid")
  .style("border-width", "2px")
  .style("border-radius", "5px")
  .style("padding", "5px")

// Three function that change the tooltip when user hover / move / leave a cell
const mouseover = function(event, d) {
  Tooltip
    .style("opacity", 1)
}
const mousemove = function(event, d) {
  Tooltip
    .html('<u>' + d.Name + '</u>' + "<br>" + d.Calories + " Calories" + "<br>" + d['Protein (g)'])
    .style("right", (event.x/2+20) + "px")
    .style("top", (event.y/2-30) + "px")
}
var mouseleave = function(event, d) {
  Tooltip
    .style("opacity", 0)
}

// Initialize the circle: all located at the center of the svg3 area
var node = svg3.append("g")
  .attr("transform",
          "translate(" + margin.left + "," + 100 + ")")
  .selectAll("circle")
  .data(data)
  .join("circle")
    .attr("class", "node")
    .attr("r", d => size(d['Protein (g)']))
    .attr("cx", width)
    .attr("cy", height)
    .style("fill", d => color(d.Food_Group))
    .style("fill-opacity", 0.6)
    .attr("stroke", "black")
    .style("stroke-width", 1)
    .on("mouseover", mouseover) // What to do when hovered
    .on("mousemove", mousemove)
    .on("mouseleave", mouseleave)
    .call(d3.drag() // call specific function when circle is dragged
         .on("start", dragstarted)
         .on("drag", dragged)
         .on("end", dragended));

// Features of the forces applied to the nodes:
const simulation = d3.forceSimulation()
    .force("center", d3.forceCenter().x(width/2).y(height/2)) // Attraction to the center of the svg area
    .force("charge", d3.forceManyBody().strength(.1)) // Nodes are attracted one each other of value is > 0
    .force("collide", d3.forceCollide().strength(.2).radius(function(d){ return (size(d['Protein (g)'])+3) }).iterations(1)) // Force that avoids circle overlapping

// Apply these forces to the nodes and update their positions.
// Once the force algorithm is happy with positions ('alpha' value is low enough), simulations will stop.
simulation
    .nodes(data)
    .on("tick", function(d){
      node
          .attr("cx", d => d.x)
          .attr("cy", d => d.y)
    });

// What happens when a circle is dragged?
function dragstarted(event, d) {
  if (!event.active) simulation.alphaTarget(.03).restart();
  d.fx = d.x;
  d.fy = d.y;
}
function dragged(event, d) {
  d.fx = event.x;
  d.fy = event.y;
}
function dragended(event, d) {
  if (!event.active) simulation.alphaTarget(.03);
  d.fx = null;
  d.fy = null;
}

})

</script>
  </div>


   
  </div>

<!-- W3.CSS Container
//<div class="w3-light-grey w3-container w3-padding-32" style="margin-top:75px;padding-right:58px"><p class="w3-right">Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-opacity">w3.css</a></p></div> -->

<script>
// Script to open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}


</script>

</body>
</html>